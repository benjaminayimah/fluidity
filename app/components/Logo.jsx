'use client'

import React, { useEffect, useState, forwardRef } from 'react'
import { useAnimation, motion } from 'framer-motion'
import useWindowSize from '@/app/hooks/useWindowSize'
import styles from '../styles/logo.module.css'
import Link from 'next/link'
import Magnetic from './Magnetic'

const Logo = forwardRef(({}, ref) => {
  const { height } = useWindowSize()
  const controls = useAnimation()
  const scrollY = useScrollY()

  useEffect(() => {
    const threshold = height * 0.8
    const transition = { duration: 0.5, ease: 'easeOut' }
    if (scrollY > threshold) {
      controls.start({
        x: -100,
        transition,
      })
    } else {
      controls.start({
        x: 0,
        transition
      })
    }
  }, [scrollY, height, controls])

  return (
    <div className={`flex fixed top-[2vw] ${styles.wrapper}`}>
      <Magnetic>
        <Link ref={ref} href="/" className="p-2 flex gap-1">
          <svg className="h-[24px] sm:h-[28px]" viewBox="0 0 40.128 27.297">
            <path
              d="M0,13.649a13.687,13.687,0,0,1,6.544-11.8A12.734,12.734,0,0,1,13.347,0a12.428,12.428,0,0,1,6.545,1.765A13.114,13.114,0,0,1,24.5,6.372a10.18,10.18,0,0,1,2.712-1.808,8.873,8.873,0,0,1,3.444-.646A9.048,9.048,0,0,1,35.478,5.21a9.781,9.781,0,0,1,3.4,3.531,9.908,9.908,0,0,1,1.249,4.908,9.753,9.753,0,0,1-1.249,4.908,9.44,9.44,0,0,1-3.4,3.487,8.826,8.826,0,0,1-4.822,1.335,8.39,8.39,0,0,1-3.444-.689A9.4,9.4,0,0,1,24.5,20.925a13.114,13.114,0,0,1-4.607,4.607A12.428,12.428,0,0,1,13.347,27.3,12.58,12.58,0,0,1,6.588,25.4a13.878,13.878,0,0,1-4.822-4.994A13.426,13.426,0,0,1,0,13.649Zm5.6,0a7.613,7.613,0,0,0,1.033,3.918,8.161,8.161,0,0,0,2.8,2.8A7.612,7.612,0,0,0,13.347,21.4a7.613,7.613,0,0,0,3.918-1.033,7.7,7.7,0,0,0,2.8-2.8A7.613,7.613,0,0,0,21.1,13.649a7.612,7.612,0,0,0-1.033-3.918,8.161,8.161,0,0,0-2.8-2.8A7.613,7.613,0,0,0,13.347,5.9,7.613,7.613,0,0,0,9.429,6.932a8.69,8.69,0,0,0-2.8,2.8A7.613,7.613,0,0,0,5.6,13.649Zm20.408,0a4.137,4.137,0,0,0,1.292,3.1A4.278,4.278,0,0,0,30.44,18.04a4.228,4.228,0,0,0,3.1-1.292,4.137,4.137,0,0,0,1.292-3.1A4.41,4.41,0,0,0,30.44,9.257,4.354,4.354,0,0,0,27.3,10.506,4.278,4.278,0,0,0,26.006,13.649Z"
              fill="#fff"
            />
          </svg>
          <div className="overflow-hidden">
            <motion.svg
              animate={controls}
              className="h-[24px] sm:h-[28px] mt-0.5"
              viewBox="0 0 66.509 27.352"
            >
              {/* ... inner path content unchanged ... */}
              <path
                d="M-1952.666,26.807a6.128,6.128,0,0,1-2.317-1.442,4.988,4.988,0,0,1-1.216-2.008l3.358-.814a3.666,3.666,0,0,0,.659.916,3.232,3.232,0,0,0,1.164.762,4.867,4.867,0,0,0,1.864.309,4.287,4.287,0,0,0,2.626-.772,2.908,2.908,0,0,0,1.04-2.513v-3h-.185a5.312,5.312,0,0,1-.845,1.184,4.319,4.319,0,0,1-1.452,1.02,5.407,5.407,0,0,1-2.255.412,6.5,6.5,0,0,1-3.306-.855,6.125,6.125,0,0,1-2.348-2.575,9.533,9.533,0,0,1-.865-4.3,10.061,10.061,0,0,1,.865-4.4A6.425,6.425,0,0,1-1953.521,6a6.063,6.063,0,0,1,3.306-.937,4.871,4.871,0,0,1,2.287.473,4.412,4.412,0,0,1,1.442,1.122,6.238,6.238,0,0,1,.814,1.226h.205V5.273h3.676V21.348a5.555,5.555,0,0,1-.967,3.358,5.812,5.812,0,0,1-2.647,1.987,10.364,10.364,0,0,1-3.811.659A9.761,9.761,0,0,1-1952.666,26.807Zm1.4-18.032a3.937,3.937,0,0,0-1.256,1.782,7.228,7.228,0,0,0-.422,2.553,7.045,7.045,0,0,0,.422,2.544,3.754,3.754,0,0,0,1.267,1.688,3.489,3.489,0,0,0,2.07.6,3.462,3.462,0,0,0,2.018-.577A3.551,3.551,0,0,0-1945.9,15.7a6.993,6.993,0,0,0,.432-2.6,7.258,7.258,0,0,0-.432-2.615,3.734,3.734,0,0,0-1.256-1.741,3.25,3.25,0,0,0-2.029-.628A3.286,3.286,0,0,0-1951.266,8.774Zm16.178,11.606a6.924,6.924,0,0,1-2.636-2.853,9.382,9.382,0,0,1-.927-4.284,9.446,9.446,0,0,1,.927-4.294,6.906,6.906,0,0,1,2.636-2.863,7.657,7.657,0,0,1,4.018-1.02,7.654,7.654,0,0,1,4.016,1.02,6.839,6.839,0,0,1,2.626,2.863,9.355,9.355,0,0,1,.937,4.294,9.292,9.292,0,0,1-.937,4.284,6.856,6.856,0,0,1-2.626,2.853,7.663,7.663,0,0,1-4.016,1.02A7.666,7.666,0,0,1-1935.087,20.381Zm1.9-11.658a4.228,4.228,0,0,0-1.267,1.885,7.916,7.916,0,0,0-.411,2.626,7.884,7.884,0,0,0,.411,2.615,4.231,4.231,0,0,0,1.267,1.875,3.3,3.3,0,0,0,2.142.689,3.209,3.209,0,0,0,2.1-.689,4.155,4.155,0,0,0,1.256-1.875,7.679,7.679,0,0,0,.423-2.615,7.709,7.709,0,0,0-.423-2.626,4.154,4.154,0,0,0-1.256-1.885,3.177,3.177,0,0,0-2.1-.7A3.268,3.268,0,0,0-1933.192,8.723Zm-37.663,11.658a6.926,6.926,0,0,1-2.637-2.853,9.384,9.384,0,0,1-.926-4.284,9.448,9.448,0,0,1,.926-4.294,6.909,6.909,0,0,1,2.637-2.863,7.65,7.65,0,0,1,4.016-1.02,7.653,7.653,0,0,1,4.017,1.02A6.839,6.839,0,0,1-1960.2,8.95a9.357,9.357,0,0,1,.937,4.294,9.293,9.293,0,0,1-.937,4.284,6.856,6.856,0,0,1-2.626,2.853,7.662,7.662,0,0,1-4.017,1.02A7.658,7.658,0,0,1-1970.855,20.381Zm1.894-11.658a4.235,4.235,0,0,0-1.266,1.885,7.893,7.893,0,0,0-.412,2.626,7.862,7.862,0,0,0,.412,2.615,4.238,4.238,0,0,0,1.266,1.875,3.3,3.3,0,0,0,2.142.689,3.209,3.209,0,0,0,2.1-.689,4.166,4.166,0,0,0,1.257-1.875,7.7,7.7,0,0,0,.422-2.615,7.734,7.734,0,0,0-.422-2.626,4.164,4.164,0,0,0-1.257-1.885,3.177,3.177,0,0,0-2.1-.7A3.268,3.268,0,0,0-1968.961,8.723ZM-1990,21.091V0h3.821V17.888h9.289v3.2Z" transform="translate(1990)" fill="#fff"/>
            </motion.svg>
          </div>
        </Link>
      </Magnetic>
    </div>
  )
})

export default Logo


function useScrollY() {
  const [scrollY, setScrollY] = useState(0)

  useEffect(() => {
    const handleScroll = () => setScrollY(window.scrollY)
    window.addEventListener('scroll', handleScroll)
    handleScroll() // set initial scroll position

    return () => window.removeEventListener('scroll', handleScroll)
  }, [])

  return scrollY
}